PRO mjo_seychelles_weighting_distributions

weightings=[[1.65,0.63,1.40,1.45,1.22,0.76,0.67,2.00],$
            [0.26,0.46,1.91,0.16,0.00,1.25,1.20,0.00],$
            [0.84,0.02,0.93,0.27,1.10,2.68,0.45,0.59],$
            [3.21,0.18,1.46,0.32,0.56,0.23,0.02,1.11],$
            [1.27,0.63,0.64,2.46,0.46,0.45,0.61,0.73],$
            [0.80,1.66,0.78,0.03,2.39,3.88,0.00,0.46],$
            [1.39,1.47,1.01,0.85,0.13,0.91,2.81,0.69],$
            [0.51,1.66,0.01,0.21,1.39,2.37,0.91,1.31],$
            [0.00,1.09,0.61,2.00,0.19,1.43,0.35,1.81],$
            [1.48,1.84,0.80,0.58,0.97,0.48,0.44,0.65],$
            [2.06,0.73,0.26,0.19,0.43,1.40,1.73,0.72],$
            [0.92,1.64,1.69,0.29,0.71,1.55,0.74,1.82],$
            [0.84,1.59,0.73,0.15,1.79,0.01,0.01,1.17],$
            [1.12,0.34,0.24,0.08,0.00,3.27,0.48,1.33],$
            [1.84,1.42,1.40,0.51,0.93,0.00,0.98,1.16],$
            [2.95,0.52,0.92,0.35,0.78,3.80,0.83,2.76],$
            [0.20,0.85,0.56,1.32,1.24,0.12,1.37,3.25],$
            [0.70,0.15,0.63,0.15,2.01,0.54,0.66,0.79],$
            [2.57,1.56,0.66,1.15,1.04,1.04,0.09,0.55],$
            [2.28,1.78,0.92,0.53,0.28,0.64,0.71,1.85],$
            [0.78,0.94,0.28,0.35,1.04,0.79,1.77,1.23],$
            [0.88,2.94,0.00,0.91,1.87,0.48,0.44,0.12],$
            [0.00,0.65,1.66,0.85,1.18,2.53,0.45,0.65],$
            [0.39,0.67,1.18,1.03,0.46,0.33,0.83,2.29],$
            [0.19,0.48,0.65,3.92,2.55,1.40,1.94,0.08],$
            [1.70,1.48,0.67,0.78,0.72,0.57,1.55,1.52],$
            [0.45,0.00,0.53,0.31,3.04,1.51,0.12,0.61],$
            [1.39,1.10,1.20,0.23,0.65,4.18,0.17,0.10],$
            [1.03,0.86,0.30,0.29,2.78,1.40,0.31,1.02],$
            [0.28,0.66,1.84,0.29,0.92,1.00,0.92,2.80],$
            [0.49,0.90,0.57,0.08,0.73,1.08,2.26,1.16],$
            [2.77,0.98,0.50,0.92,0.35,4.34,1.76,0.67],$
            [2.60,1.16,1.33,1.60,0.55,2.30,0.61,0.43],$
            [0.00,2.09,1.85,0.51,0.57,1.12,0.75,0.00],$
            [0.85,0.56,0.52,0.80,0.69,0.56,2.93,0.32]]
;            [0.19,0.07,0.00,0.00,0.38,1.02,1.35,1.92]]

psfile='/home/ss901165/idl/seychelles/mjo_seychelles_weighting_distributions.by_phase_1979-2014.ps'
PSOPEN,file=psfile,FONT=6,CHARSIZE=150,MARGIN=2500,YOFFSET=500,XOFFSET=1000,TFONT=6,TCHARSIZE=120,SPACE2=100,SPACE3=100
GSET,XMIN=0,XMAX=8,YMIN=0.15,YMAX=6.0,/YLOG,TITLE='Effect of MJO phase on daily wet-season Seychelles rainfall'

a=[1.1,1.2,1.0,1.0,1.2,1.2,1.1,1.0]
wavg=[1.13,1.07,0.91,0.76,1.06,1.27,0.99,0.97]
FOR i=0,7 DO BEGIN
   pts=fltarr(5)
   this_phase=REFORM(weightings(i,*))*a(i)
   sorted=SORT(this_phase)
   pts(0)=this_phase(sorted(N_ELEMENTS(this_phase)/7))
   pts(1)=this_phase(sorted(N_ELEMENTS(this_phase)/3))
   pts(2)=MEDIAN(this_phase)   
   pts(3)=this_phase(sorted(N_ELEMENTS(this_phase)*2/3))
   pts(4)=this_phase(sorted(N_ELEMENTS(this_phase)*6/7))
   GPLOT,X=i+0.5,Y=wavg(i),/NOLINES,SYM=3,COL=FSC_COLOR('red'),SIZE=200
   EBAR,X=i+0.5,BOX=pts,THICK=250,WIDTH=150
ENDFOR
GPLOT,X=[0,8],Y=[1.0,1.0],STYLE=1
AXES,XVALS=indgen(8)+0.5,XLABELS=STRMID(STRTRIM(STRING(indgen(8)+1),1),0,1),YVALS=['0.17','0.20','0.25','0.33','0.40','0.50','0.60','0.75','1.0','1.33','1.67','2.0','2.5','3.0','4.0','5.0','6.0'],$
     XTITLE='Wheeler and Hendon (2004) MJO phase',YTITLE='<--- Reduces rainfall   (Clim)   Increases rainfall --->',NDECS=2
GLEGEND,labels=['All wet seasons in 1979-2013'],LEGPOS=1,STYLE=0,$
        SYM=[0],COL=FSC_COLOR('black'),/NOLEGENDBOX
GLEGEND,labels=['Weighted average of all seasons'],LEGPOS=9,STYLE=0,$
        SYM=[3],COL=FSC_COLOR('red'),LENGTH=0,/NOLEGENDBOX

PSCLOSE

STOP
END


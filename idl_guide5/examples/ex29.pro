PRO ex29
d=NCREAD('katrina.nc')
cats=['EXTRATROPICAL-DEPRESSION', 'TROPICAL-DEPRESSION', 'TROPICAL-STORM',$
      'HURRICANE-1','HURRICANE-2','HURRICANE-3','HURRICANE-4','HURRICANE-5']
PSOPEN
CS, SCALE=1
MAP, LONMIN=-100, LONMAX=-60, LATMIN=10, LATMAX=50, OCEAN=10, LAND=11, /HIRES, /DRAW
CS, COLS=[425, 122, 230, 252, 288, 358, 43, 399]
FOR ix=0, N_ELEMENTS(d.lon)-2 DO BEGIN
 cat=WHERE(STRING(BYTE(d.status(*,ix))) EQ cats)
 mycat=cat(0)
 GPLOT, X=[d.lon(ix), d.lon(ix+1)], Y=[d.lat(ix), d.lat(ix+1)] , THICK=300, $
        SIZE=60, SYM=3, COL=mycat+2
ENDFOR
GLEGEND, LEGPOS=9, LABELS=cats, COL=INDGEN(8)+2, FILLCOL=0, TYPE=1 
GPLOT, X=14750, Y=19000, CHARSIZE=200, /DEVICE, TEXT='Hurricane Katrina - dots are six hours apart'
AXES, STEP=10
PSCLOSE
END

